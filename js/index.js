!function(t){t.add("tl/requestAFrame",function(){function t(){for(var i in n){var a=n[i];if(r%a.timer===0)if(a.times--){var o=a();o===!1&&delete n[i]}else delete n[i]}e(t),r=(r+1)%18e3}var e=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)}}(),n={},r=0;return t(),{addTimeout:function(t,e,r,i){e.timer=Math.floor(60*(r||200)/1e3),e.times=i||1/0,n[t]=e}}}),t.add("tl/dateUtil",function(){var t=function(t){return 10>t?"0"+t:t},e={reg:/([yMdhms\$]{1,2})/g,days:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],yy:function(t){return t.getFullYear()},M:function(t){return 1+t.getMonth()},MM:function(e){return t(1+e.getMonth())},d:function(t){return t.getDate()},dd:function(e){return t(e.getDate())},h:function(t){return t.getHours()},hh:function(e){return t(e.getHours())},m:function(t){return t.getMinutes()},mm:function(e){return t(e.getMinutes())},s:function(t){return t.getSeconds()},ss:function(e){return t(e.getSeconds())},$:function(t){return this.days[t.getDay()]},$$:function(t){return this.days[t.getDay()]}};return{format:function(t,n,r){return window.jQuery&&(r=jQuery.extend({},e,r)),n.replace(e.reg,function(n,r){return e[r](t)})},parse:function(t,n){n=n||"yy/MM/dd hh:mm:ss";for(var r={},i=t.match(/\d{1,4}/g),a=n.match(e.reg),o=0;o<a.length;o++)r[a[o]]=i[o];return new Date("yy/MM/dd hh:mm:ss".replace(e.reg,function(t,e){return r[e]||0}))}}}),t.add("tl/render",function(t,e){var n={0:{date:"yy年",stamp:"yy年"},1:{date:"yy年MM月",stamp:"M月"},2:{date:"yy年M月d日",stamp:"M月dd日"},3:{date:"yy年M月d日",stamp:"hh:mm′"},4:{date:"yy年M月d日",stamp:"hh:mm′"},5:{date:"yy年M月d日",stamp:"hh:mm′ss″"}};return function(r){var i=[],a=[];t.each(r,function(t,r){var o=new Date;m=n[t.timeLevel||4],o.setTime(t.time),t.timeStamp=e.format(o,m.stamp),t.timeDate=e.format(o,m.date),a.push(e.format(o,m.stamp)),i.push('<li class="'+(r%2?"right":"left")+'" data-timedate="{{timeDate}}" title="{{desc}}"><img class="bg" src="{{typeData}}@300x200" alt="{{title}}"/><div class="title-info"><h4>{{title}}</h4></div></li>'.replace(/\{\{(\w+)\}\}/g,function(e,n){return t[n]||""}))}),this.list=i.join(""),this.slides='<li><a href="javascript:void(0);">'+a.join('</a></li><li><a href="javascript:void(0);">')+"</a></li>"}},{requires:["tl/dateUtil"]}),t.add("tl/snapshot",function(t,e){var n=e.all,r=n(".time-label"),i=function(t,e){var n=t.children(),i=e.children(),a=n.length;this.on=function(t){t.t>a-1?t.t=a-1:t.t<0&&(t.t=0);var o=0|t.t;e.css({left:t.t>2?98*(2-t.t):0}),t.t==t.tar&&i.item(o).addClass("current").siblings().removeClass("current"),n.each(function(e,n){var i=e.attr("class"),s="left"===i?"margin-right":"margin-left",u=1-(n-t.t)/a*3,d={width:40*u+"%",height:50*u+"%",zIndex:a-n,marginBottom:13*(n-t.t)+"%"};d["text-indent"]=.5>u?"-9999em":"0",d[s]=-5*(n-t.t)/Math.max(n,t.t,3)+"%",d.display=n+1<t.t?"none":"block";var c=n+1-t.t;d.opacity=c,e.css(d),n===o&&r.html(e.attr("data-timedate"))})}};return i},{requires:["node"]}),t.add("tl/index",function(t,e,n,r,i){var a=e.all,o=a(document),s=(o.width(),o.height(),a("#way"),a("#stars"),a("#list")),u=a("#slide"),d=new r(data.content);s.html(d.list),u.html(d.slides);var c=new i(s,u),l={t:0,tar:0};n.addTimeout("snap",function(){Math.abs(l.tar-l.t)>.01&&(l.t+=l.tar>l.t?.0625:-.0625),c.on(l)},20),a(document).on("mousewheel",function(t){return l.tar=l.t-.25*t.deltaY,l.t=l.tar,!1}).on("keyup",function(t){switch(t.keyCode){case 37:case 38:l.tar=Math.floor(l.t)-1;break;case 39:case 40:l.tar=Math.floor(l.t)+1}return!1}),a(".time-slide").delegate("click",".left",function(){l.tar=Math.floor(l.t)-1}).delegate("click",".right",function(){l.tar=Math.floor(l.t)+1}),s.children().on("click",function(){l.tar=a(this).index()}),u.children().on("click",function(){l.tar=a(this).index()})},{requires:["node","tl/requestAFrame","tl/render","tl/snapshot"]})}(KISSY);